/*
jQWidgets v4.5.3 (2017-June)
Copyright (c) 2011-2017 jQWidgets.
License: http://jqwidgets.com/license/
*/
!function(a){a.extend(a.jqx._jqxChart.prototype,{_moduleRangeSelector:!0,_renderXAxisRangeSelector:function(b,c){var d=this;d._isTouchDevice=a.jqx.mobile.isTouchDevice();var e=d.seriesGroups[b],f=d._getXAxis(b),g=f?f.rangeSelector:void 0;if(!d._isSelectorRefresh){(g&&g.renderTo?g.renderTo:d.host).find(".rangeSelector").remove()}if(!f||0==f.visible||"spider"==e.type)return!1;if(!d._isGroupVisible(b))return!1;if(!g)return!1;var h="horizontal"==e.orientation;g.renderTo&&(h=!1),d.rtl&&(f.flip=!0);var i=h?this.host.height():this.host.width();i-=4;var j=this._getXAxisStats(b,f,i),k=f.position;if(g.renderTo&&g.position&&(k=g.position),!this._isSelectorRefresh){var l=g.renderTo,m=a("<div class='rangeSelector jqx-disableselect' style='position: absolute; background-color: transparent;' onselectstart='return false;'></div>").appendTo(l||this.renderer.getContainer());if(l)m.css({width:l.width(),height:l.height()}),c.width=l.width(),c.height=l.height();else{var n=this.host.coord();n.top=0,n.left=0,selectorSize=this._selectorGetSize(f),h?(m.css("left",n.left+1+c.x+("right"!=k?-selectorSize:c.width)),m.css("top",n.top),m.css("height",i),m.css("width",selectorSize),c.height=selectorSize):(m.css("left",n.left+1),m.css("top",n.top+c.y+("top"!=k?c.height:-selectorSize)),m.css("height",selectorSize),m.css("width",i))}this._refreshSelector(b,f,j,m,c,h)}return this._isSelectorRefresh=!1,!0},_refreshSelector:function(b,c,d,e,f,g){var h={},i=c.rangeSelector;this.seriesGroups[b];for(var j in i)h[j]=i[j];delete h.padding;var k=h.minValue,l=h.maxValue;void 0==k&&(k=Math.min(d.min.valueOf(),d.dsRange.min.valueOf())),void 0==l&&(l=Math.max(d.max.valueOf(),d.dsRange.max.valueOf())),this._isDate(d.min)&&(k=new Date(k)),this._isDate(d.max)&&(l=new Date(l));var m=c.position;i.renderTo&&i.position&&(m=i.position),h.dataField=c.dataField,delete h.rangeSelector,h.type=c.type,h.baseUnit=i.baseUnit||c.baseUnit,h.minValue=k,h.maxValue=l,h.flip=c.flip,h.position=m;var n=2,o=2,p=2,q=2;i.renderTo||(n=g?0:f.x,o=g?0:this._rect.width-f.x-f.width,p=g?f.y:5,q=g?this._paddedRect.height-this._plotRect.height:5);var r=i.padding;r=void 0!=r||i.renderTo?{left:r&&r.left?r.left:n,top:r&&r.top?r.top:p,right:r&&r.right?r.right:o,bottom:r&&r.bottom?r.bottom:q}:{left:n,top:p,right:o,bottom:q};for(var s=c.rangeSelector.dataField,j=0;void 0==s&&j<this.seriesGroups.length;j++)for(var t=0;void 0==s&&t<this.seriesGroups[j].series.length;t++)s=this.seriesGroups[j].series[t].dataField;var u={padding:r,_isRangeSelectorInstance:!0,title:i.title||"",description:i.description||"",titlePadding:i.titlePadding,colorScheme:i.colorScheme||this.colorScheme,backgroundColor:i.backgroundColor||this.backgroundColor||"transparent",backgroundImage:i.backgroundImage||"",showBorderLine:i.showBorderLine||!!i.renderTo,borderLineWidth:i.borderLineWidth||this.borderLineWidth,borderLineColor:i.borderLineColor||this.borderLineColor,rtl:i.rtl||this.rtl,greyScale:i.greyScale||this.greyScale,renderEngine:this.renderEngine,showLegend:!1,enableAnimations:!1,enableEvents:!1,showToolTips:!1,source:this.source,xAxis:h,seriesGroups:[{orientation:g?"horizontal":"vertical",valueAxis:{visible:!1},type:c.rangeSelector.serieType||"area",skipOverlappingPoints:a.jqx.getByPriority([c.rangeSelector.skipOverlappingPoints,!0]),columnSeriesOverlap:a.jqx.getByPriority([c.rangeSelector.columnSeriesOverlap,!1]),columnsGapPercent:a.jqx.getByPriority([c.rangeSelector.columnsGapPercent,25]),seriesGapPercent:a.jqx.getByPriority([c.rangeSelector.seriesGapPercent,25]),series:[{dataField:s,opacity:.8,lineWidth:1}]}]};u.showBorderLine||(u.borderLineWidth=1,u.borderLineColor=a.jqx.getByPriority([this.backgroundColor,this.background,"#FFFFFF"]),u.showBorderLine=!0);var v=this;v._supressBindingRefresh=!0,e.empty(),e.jqxChart(u),v._rangeSelectorInstances[b]=e,v._supressBindingRefresh=!1,e.on(v._getEvent("mousemove"),function(){v._unselect(),v._hideToolTip()});var w=e.jqxChart("getInstance");if(w._plotRect){var x=w._paddedRect;if(x.height=w._plotRect.height,g||"top"!=m){if(g){var y=w._renderData[0].xAxis.rect.width;x.width-=y,"right"!=m&&(x.x+=y)}}else x.y+=w._renderData[0].xAxis.rect.height;v._createSliderElements(b,e,x,i),v.removeHandler(a(document),v._getEvent("mousemove")+"."+this.element.id,v._onSliderMouseMove),v.removeHandler(a(document),v._getEvent("mousedown"),v._onSliderMouseDown),v.removeHandler(a(document),v._getEvent("mouseup")+"."+this.element.id,v._onSliderMouseUp),v.addHandler(a(document),v._getEvent("mousemove")+"."+this.element.id,v._onSliderMouseMove,{self:this,groupIndex:b,renderTo:e,swapXY:g}),v.addHandler(a(e),v._getEvent("mousedown"),this._onSliderMouseDown,{self:this,groupIndex:b,renderTo:e,swapXY:g}),v.addHandler(a(document),v._getEvent("mouseup")+"."+this.element.id,v._onSliderMouseUp,{element:this.element.id,self:this,groupIndex:b,renderTo:e,swapXY:g})}},_createSliderElements:function(b,c,d,e){c.find(".slider").remove();var f=e.selectedRangeColor||"blue",g=a.jqx.getByPriority([e.selectedRangeOpacity,.1]),h=a.jqx.getByPriority([e.unselectedRangeOpacity,.5]),i=e.unselectedRangeColor||"white",j=e.rangeLineColor||"grey",k=a("<div class='slider' style='position: absolute;'></div>");for(k.css({background:f,opacity:g,left:d.x,top:d.y,width:d.width,height:d.height}),k.appendTo(c);this._sliders.length<b+1;)this._sliders.push({});var l="<div class='slider' style='position: absolute;  background: "+i+"; opacity: "+h+";'></div>",m="<div class='slider' style='position: absolute; background:"+j+"; opacity: "+h+";'></div>",n="<div class='slider jqx-rc-all' style='position: absolute; background: white; border-style: solid; border-width: 1px; border-color: "+j+";'></div>";this._sliders[b]={element:k,host:c,_sliderInitialAbsoluteRect:{x:k.coord().left,y:k.coord().top,width:d.width,height:d.height},_hostInitialAbsolutePos:{x:c.coord().left,y:c.coord().top},getRect:function(){return{x:this.host.coord().left-this._hostInitialAbsolutePos.x+this._sliderInitialAbsoluteRect.x,y:this.host.coord().top-this._hostInitialAbsolutePos.y+this._sliderInitialAbsoluteRect.y,width:this._sliderInitialAbsoluteRect.width,height:this._sliderInitialAbsoluteRect.height}},rect:d,left:a(l),right:a(l),leftTop:a(m),rightTop:a(m),leftBorder:a(m),leftBar:a(n),rightBorder:a(m),rightBar:a(n)},this._sliders[b].left.appendTo(c),this._sliders[b].right.appendTo(c),this._sliders[b].leftTop.appendTo(c),this._sliders[b].rightTop.appendTo(c),this._sliders[b].leftBorder.appendTo(c),this._sliders[b].rightBorder.appendTo(c),this._sliders[b].leftBar.appendTo(c),this._sliders[b].rightBar.appendTo(c);var o=this._renderData[b].xAxis,p=o.data.axisStats,q=p.min.valueOf(),r=p.max.valueOf(),s=this._valueToOffset(b,q),t=this._valueToOffset(b,r);if(s>t){var u=t;t=s,s=u}"horizontal"!=this.seriesGroups[b].orientation?k.css({left:Math.round(d.x+s),top:d.y,width:Math.round(t-s),height:d.height}):k.css({top:Math.round(d.y+s),left:d.x,height:Math.round(t-s),width:d.width}),this._setSliderPositions(b,s,t)},_setSliderPositions:function(a,b,c){var d=this.seriesGroups[a],e=this._getXAxis(a),f=e.rangeSelector,g="horizontal"==d.orientation;e.rangeSelector.renderTo&&(g=!1);var h=e.position;f.renderTo&&f.position&&(h=f.position);var i=this._sliders[a],j=g?"top":"left",k=g?"left":"top",l=g?"height":"width",m=g?"width":"height",n=g?"y":"x",o=g?"x":"y",p=i.rect;i.startOffset=b,i.endOffset=c,i.left.css(j,p[n]),i.left.css(k,p[o]),i.left.css(l,b),i.left.css(m,p[m]),i.right.css(j,p[n]+c),i.right.css(k,p[o]),i.right.css(l,p[l]-c+1),i.right.css(m,p[m]),i.leftTop.css(j,p[n]),i.leftTop.css(k,p[o]+(g&&"right"==h||!g&&"top"!=h?0:p[m])),i.leftTop.css(l,b),i.leftTop.css(m,1),i.rightTop.css(j,p[n]+c),i.rightTop.css(k,p[o]+(g&&"right"==h||!g&&"top"!=h?0:p[m])),i.rightTop.css(l,p[l]-c+1),i.rightTop.css(m,1),i.leftBorder.css(j,p[n]+b),i.leftBorder.css(k,p[o]),i.leftBorder.css(l,1),i.leftBorder.css(m,p[m]);var q=p[m]/4;q>20&&(q=20),q<3&&(q=3),i.leftBar.css(j,p[n]+b-3),i.leftBar.css(k,p[o]+p[m]/2-q/2),i.leftBar.css(l,5),i.leftBar.css(m,q),i.rightBorder.css(j,p[n]+c),i.rightBorder.css(k,p[o]),i.rightBorder.css(l,1),i.rightBorder.css(m,p[m]),i.rightBar.css(j,p[n]+c-3),i.rightBar.css(k,p[o]+p[m]/2-q/2),i.rightBar.css(l,5),i.rightBar.css(m,q)},_resizeState:{},_onSliderMouseDown:function(b){b.stopImmediatePropagation(),b.stopPropagation();var c=b.data.self;c._sliders[b.data.groupIndex]&&(void 0==c._resizeState.state&&c._testAndSetReadyResize(b),"ready"==c._resizeState.state&&(a.jqx._rangeSelectorTarget=c,c._resizeState.state="resizing"))},_valueToOffset:function(a,b){var c=this.seriesGroups[a],d=this._sliders[a],e=d.host.jqxChart("getInstance"),f=e._renderData[0].xAxis,g=f.data.axisStats,h=g.min.valueOf(),i=g.max.valueOf(),j=i-h;0==j&&(j=1);var k=this._getXAxis(a),l="horizontal"==c.orientation?"height":"width",m=(b.valueOf()-h)/j;return d.getRect()[l]*(k.flip?1-m:m)},_offsetToValue:function(a,b){var c=this._sliders[a],d=this.seriesGroups[a],e=this._getXAxis(a),f="horizontal"==d.orientation?"height":"width",g=c.getRect()[f];0==g&&(g=1);var h=c.host.jqxChart("getInstance"),i=h._renderData[0].xAxis,j=i.data.axisStats,k=j.min.valueOf(),l=j.max.valueOf(),m=b/g*(l-k)+k;return 1==e.flip&&(m=l-b/g*(l-k)),this._isDate(j.min)||this._isDate(j.max)?m=new Date(m):((void 0==e.dataField||j.useIndeces)&&(m=Math.round(m)),m<j.min&&(m=j.min),m>j.max&&(m=j.max)),m},_onSliderMouseUp:function(b){var c=a.jqx._rangeSelectorTarget;if(c){var d=b.data.groupIndex,e=b.data.swapXY,f=c._sliders[d];if(f&&"resizing"==c._resizeState.state){b.stopImmediatePropagation(),b.stopPropagation(),c._resizeState={},c.host.css("cursor","default");var g=e?"top":"left",h=e?"y":"x",i=f.element.coord()[g],j=i+(e?f.element.height():f.element.width()),k=f.getRect(),l=c._offsetToValue(d,i-k[h]),m=c._offsetToValue(d,j-k[h]);!f.host.jqxChart("getInstance")._renderData[0].xAxis.data.axisStats.isTimeUnit&&m.valueOf()-l.valueOf()>864e5&&(l.setHours(0,0,0,0),m.setDate(m.getDate()+1),m.setHours(0,0,0,0));var n=c._getXAxis(d);if(n.flip){var o=l;l=m,m=o}for(var p=0;p<c.seriesGroups.length;p++){c._getXAxis(p)==n&&(c._selectorRange[p]={min:l,max:m})}c._isSelectorRefresh=!0;var q=c.enableAnimations;c._raiseEvent("rangeSelectionChanging",{instance:c,minValue:l,maxValue:m}),c.enableAnimations=!1,c.update(),c.enableAnimations=q,c._raiseEvent("rangeSelectionChanged",{instance:c,minValue:l,maxValue:m})}}},_onSliderMouseMove:function(b){var c=b.data.self,d=(b.data.renderTo,b.data.groupIndex),e=c._sliders[d],f=b.data.swapXY;if(e){var g=e.getRect(),h=e.element,i=a.jqx.position(b),j=h.coord(),k=f?"top":"left",l=f?"height":"width",m=f?"y":"x";if("resizing"==c._resizeState.state){if(b.stopImmediatePropagation(),b.stopPropagation(),"left"==c._resizeState.side){var n=Math.round(i[k]-j[k]),o=g[m];if(j[k]+n>=o&&j[k]+n<=o+g[l]){var p=parseInt(h.css(k)),q=Math.max(2,(f?h.height():h.width())-n);h.css(l,q),h.css(k,p+n)}}else if("right"==c._resizeState.side){var r=f?h.height():h.width(),n=Math.round(i[k]-j[k]-r),o=g[m];if(j[k]+r+n>=o&&j[k]+n+r<=o+g[l]){var q=Math.max(2,r+n);h.css(l,q)}}else if("move"==c._resizeState.side){var r=f?h.height():h.width(),p=parseInt(h.css(k)),n=Math.round(i[k]-c._resizeState.startPos);j[k]+n>=g[m]&&j[k]+n+r<=g[m]+g[l]&&(c._resizeState.startPos=i[k],h.css(k,p+n))}var s=parseInt(h.css(k))-e.rect[m],t=s+(f?h.height():h.width());c._setSliderPositions(d,s,t)}else c._testAndSetReadyResize(b)}},_testAndSetReadyResize:function(b){var c=b.data.self,d=b.data.renderTo,e=b.data.groupIndex,f=c._sliders[e],g=b.data.swapXY,h=f.getRect(),i=f.element,j=a.jqx.position(b),k=i.coord(),l=g?"left":"top",m=g?"top":"left",n=g?"width":"height",o=c._isTouchDevice?30:5;j[l]>=k[l]&&j[l]<=k[l]+h[n]?Math.abs(j[m]-k[m])<=o?(d.css("cursor",g?"row-resize":"col-resize"),c._resizeState={state:"ready",side:"left"}):Math.abs(j[m]-k[m]-(g?i.height():i.width()))<=o?(d.css("cursor",g?"row-resize":"col-resize"),c._resizeState={state:"ready",side:"right"}):j[m]+o>k[m]&&j[m]-o<k[m]+(g?i.height():i.width())?(d.css("cursor","pointer"),c._resizeState={state:"ready",side:"move",startPos:j[m]}):(d.css("cursor","default"),c._resizeState={}):(d.css("cursor","default"),c._resizeState={})},_selectorGetSize:function(a){return a.rangeSelector.renderTo?0:a.rangeSelector.size||this._paddedRect.height/3}})}(jqxBaseFramework);

